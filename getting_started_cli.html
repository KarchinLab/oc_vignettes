<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.549">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Getting Started with OpenCRAVAT on the Command Line</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="getting_started_cli_files/libs/clipboard/clipboard.min.js"></script>
<script src="getting_started_cli_files/libs/quarto-html/quarto.js"></script>
<script src="getting_started_cli_files/libs/quarto-html/popper.min.js"></script>
<script src="getting_started_cli_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="getting_started_cli_files/libs/quarto-html/anchor.min.js"></script>
<link href="getting_started_cli_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="getting_started_cli_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="getting_started_cli_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="getting_started_cli_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="getting_started_cli_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="getting_started_cli_files/libs/quarto-diagram/mermaid.min.js"></script>
<script src="getting_started_cli_files/libs/quarto-diagram/mermaid-init.js"></script>
<link href="getting_started_cli_files/libs/quarto-diagram/mermaid.css" rel="stylesheet">


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#learning-objectives" id="toc-learning-objectives" class="nav-link active" data-scroll-target="#learning-objectives">Learning Objectives</a>
  <ul class="collapse">
  <li><a href="#the-basic-opencravat-workflow" id="toc-the-basic-opencravat-workflow" class="nav-link" data-scroll-target="#the-basic-opencravat-workflow">The Basic OpenCRAVAT Workflow</a></li>
  <li><a href="#preparing-and-installing-open-cravat" id="toc-preparing-and-installing-open-cravat" class="nav-link" data-scroll-target="#preparing-and-installing-open-cravat">Preparing and Installing Open Cravat</a>
  <ul class="collapse">
  <li><a href="#using-a-virtual-environment" id="toc-using-a-virtual-environment" class="nav-link" data-scroll-target="#using-a-virtual-environment">Using a Virtual Environment</a></li>
  <li><a href="#installing-opencravat" id="toc-installing-opencravat" class="nav-link" data-scroll-target="#installing-opencravat">Installing OpenCRAVAT</a></li>
  </ul></li>
  <li><a href="#installing-via-bioconda" id="toc-installing-via-bioconda" class="nav-link" data-scroll-target="#installing-via-bioconda">Installing via Bioconda</a></li>
  <li><a href="#installing-annotators" id="toc-installing-annotators" class="nav-link" data-scroll-target="#installing-annotators">Installing annotators</a></li>
  <li><a href="#understanding-the-input-file-format" id="toc-understanding-the-input-file-format" class="nav-link" data-scroll-target="#understanding-the-input-file-format">Understanding the Input File Format</a></li>
  <li><a href="#annotating-our-example" id="toc-annotating-our-example" class="nav-link" data-scroll-target="#annotating-our-example">Annotating our example</a></li>
  <li><a href="#starting-the-results-viewer" id="toc-starting-the-results-viewer" class="nav-link" data-scroll-target="#starting-the-results-viewer">Starting the Results Viewer</a></li>
  <li><a href="#examining-our-results-file-and-filtering" id="toc-examining-our-results-file-and-filtering" class="nav-link" data-scroll-target="#examining-our-results-file-and-filtering">Examining our Results File and Filtering</a></li>
  <li><a href="#visualizing-our-filtered-results" id="toc-visualizing-our-filtered-results" class="nav-link" data-scroll-target="#visualizing-our-filtered-results">Visualizing Our Filtered Results</a></li>
  <li><a href="#deactivating-your-environment" id="toc-deactivating-your-environment" class="nav-link" data-scroll-target="#deactivating-your-environment">Deactivating Your Environment</a></li>
  <li><a href="#what-you-learned" id="toc-what-you-learned" class="nav-link" data-scroll-target="#what-you-learned">What You Learned</a></li>
  </ul></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="getting_started_cli.rst"><i class="bi bi-file"></i>reST</a></li></ul></div></nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Getting Started with OpenCRAVAT on the Command Line</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="learning-objectives" class="level1">
<h1>Learning Objectives</h1>
<p>Working through this document, you will learn to:</p>
<ul>
<li><strong>Prepare</strong> your system for installing OpenCRAVAT</li>
<li><strong>Install</strong> the OpenCRAVAT software locally using <code>pip</code></li>
<li><strong>Search</strong> for and <strong>Install</strong> available annotators</li>
<li><strong>Explain</strong> compatible variant formats</li>
<li><strong>Annotate</strong> variant files using the CLI tools</li>
<li><strong>Visualize</strong> and <strong>Summarize</strong> Results in OpenCRAVAT</li>
</ul>
<section id="the-basic-opencravat-workflow" class="level2">
<h2 class="anchored" data-anchor-id="the-basic-opencravat-workflow">The Basic OpenCRAVAT Workflow</h2>
<p>In the diagram below, we’ll see the basic OpenCRAVAT workflow on the command-line. Click the boxes below in the diagram to jump to that particular section.</p>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">flowchart TD
    L[Prepare for Installing] --&gt; A
    click L "#preparing-and-installing-open-cravat"
    A[Installation] --&gt; G[Install Annotators]
    click A "#installing-opencravat"
    click G "#installing-annotators"
    G --&gt; B[Convert to Input File Format]
    click B "#understanding-the-input-file-format"
    B --&gt;|Variant File Input| C[Map Variants and Annotate]
    click C "#annotating-our-example"
    C --&gt;|Results|D[Start Results Viewer]
    click D "#starting-the-results-viewer"
    D --&gt;|Results| E[Filter Results]
    click E "#examining-our-results-file-and-filtering"
    E --&gt;|Results| F[Visualizing Filtered Results]
    click F "#visualizing-our-filtered-results"
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
</section>
<section id="preparing-and-installing-open-cravat" class="level2">
<h2 class="anchored" data-anchor-id="preparing-and-installing-open-cravat">Preparing and Installing Open Cravat</h2>
<iframe src="https://share.descript.com/embed/Fraiw5qh2gJ" width="640" height="360" frameborder="0" allowfullscreen="">
</iframe>
<p>Make sure you know where your Python is installed using the <code>which</code> command. In my example, I have python 3.11 installed via Homebrew, which is the python I want to use. In my case, since I’m on MacOS, I know that I run python programs using <code>python3</code> rather than <code>python</code>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">which</span> python3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code>tedladeras@teds-MacBook-Pro ~ % which python3
/opt/homebrew/bin/python3</code></pre>
<p>Also, check whether you have <code>pip</code> or <code>pip3</code> installed, and whether it has a similar location to your <code>python3</code>.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">which</span> pip3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code>tedladeras@teds-MacBook-Pro ~ % which pip3
/opt/homebrew/bin/pip3</code></pre>
<section id="using-a-virtual-environment" class="level3">
<h3 class="anchored" data-anchor-id="using-a-virtual-environment">Using a Virtual Environment</h3>
<p>You should create a virtual environment so that your OpenCRAVAT installation is isolated from other installations. We’ll use <code>venv</code>, which installed in the default Python distribution.</p>
<p>We’ll make a separate virtual environment using the <code>venv</code> command. Here we’re creating a virtual environment called <code>oc</code>:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="ex">python3</span> <span class="at">-m</span> venv oc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>This creates a folder called <code>oc</code> in our current directory. This is where all of our separate Python packages will live. Then we’ll activate the virtual environment using <code>source</code>:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="bu">source</span> oc/bin/activate</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>You can double check whether the environment is activated by using <code>which python3</code> again. It should poiint to the <code>bin</code> folder within your virtual environment folder.. Note that our prompt also has an <code>(oc)</code> in front.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">which</span> python3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code>(oc) tedladeras@teds-MacBook-Pro ~ % which python3
/Users/tedladeras/oc/bin/python3</code></pre>
</section>
<section id="installing-opencravat" class="level3">
<h3 class="anchored" data-anchor-id="installing-opencravat">Installing OpenCRAVAT</h3>
<p>Now we can install Open Cravat using <code>pip</code>/<code>pip3</code>.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="ex">pip3</span> install open-cravat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code>tedladeras@teds-MacBook-Pro local % pip3 install open-cravat
Collecting open-cravat
  Downloading open-cravat-2.4.2.tar.gz (3.1 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 3.1/3.1 MB 40.4 MB/s eta 0:00:00
  Preparing metadata (setup.py) ... done
Collecting pyyaml (from open-cravat)
  Downloading PyYAML-6.0.1-cp311-cp311-macosx_11_0_arm64.whl.metadata (2.1 kB)
Collecting requests (from open-cravat)
  Downloading requests-2.31.0-py3-none-any.whl.metadata (4.6 kB)
Collecting requests-toolbelt (from open-cravat)
  Downloading requests_toolbelt-1.0.0-py2.py3-none-any.whl (54 kB)</code></pre>
<p>Confirm that Open Cravat is installed:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="ex">oc</span> <span class="at">--help</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code>tedladeras@teds-MacBook-Pro ~ % oc --help
usage: oc [-h] {run,report,gui,module,config,new,store,util,version,feedback} ...

Open-CRAVAT genomic variant interpreter. https://github.com/KarchinLab/open-cravat

options:
  -h, --help            show this help message and exit

Commands:
  {run,report,gui,module,config,new,store,util,version,feedback}
    run                 Run a job
    report              Generate a report from a job
    gui                 Start the GUI
    module              Change installed modules
    config              View and change configuration settings
    new                 Create new modules
    store               Publish modules to the store
    util                Utilities
    version             Show version
    feedback            Send feedback to the developers</code></pre>
<p>All of our interactions with OpenCRAVAT will be prefaced by <code>oc</code>. For example, we can launch the OpenCRAVAT GUI as a webserver on our machine using</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="ex">oc</span> gui</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Now you’re ready to start installing annotators.</p>
</section>
</section>
<section id="installing-via-bioconda" class="level2">
<h2 class="anchored" data-anchor-id="installing-via-bioconda">Installing via Bioconda</h2>
<iframe src="https://share.descript.com/embed/5ya31CMgDf5" width="640" height="360" frameborder="0" allowfullscreen="">
</iframe>
<p>If you prefer to install via <code>conda</code>/<code>mamba</code>, here are directions for you. You will want to install <code>mamba</code> via <code>miniforge</code>: download the installation scripts here.</p>
<p>When <code>mamba</code> has been installed, you’ll need to create a conda environment and install open-cravat via a single command:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="ex">mamba</span> create <span class="at">--name</span> oc open-cravat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>This will create an environment called <code>oc</code></p>
<p>When you’re ready to use Open-Cravat, you can activate this <code>oc</code> environment:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="ex">mamba</span> activate oc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Confirm that you can see the <code>oc</code> executable with <code>which</code>. It should be where you installed miniforge:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">which</span> oc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code>/Users/tedladeras/miniforge3/envs/oc/bin/oc</code></pre>
<p>Now you can use Open-Cravat as below and install annotators.</p>
</section>
<section id="installing-annotators" class="level2">
<h2 class="anchored" data-anchor-id="installing-annotators">Installing annotators</h2>
<iframe src="https://share.descript.com/embed/Fraiw5qh2gJ" width="640" height="360" frameborder="0" allowfullscreen="">
</iframe>
<p>The first thing we’ll need to install are some core bits of Open Cravat, called <code>install-base</code>. We’ll do this with the command <code>oc module</code>:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="ex">oc</span> module install-base</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code>tedladeras@teds-MacBook-Pro local % oc module install-base
Installing: casecontrol:1.2.0, cravat-converter:1.1.2, excelreporter:2.1.1, go:2022.11.01, hg38:1.11.0, hg38wgs:1.0.0, oldcravat-converter:1.1.2, tagsampler:1.1.6, textreporter:2.1.0, varmeta:1.0.0, vcf-converter:2.2.1, vcfinfo:2.0.0, wgbase:1.1.3, wgcasecontrols:1.0.1, wgcasecontrolsummary:1.0.1, wgcircossummary:2.2.0, wgcodingvsnoncodingsummary:2.0.0, wggo:1.2.0, wggosummary:2.4.0, wghg19:1.0.3, wglollipop:2.2.1, wgncrna:1.1.0, wgndex:1.1.0, wgnote:3.0.0, wgrankscore:1.1.0, wgsosamplesummary:2.2.0, wgsosummary:1.5.0, wgvcfinfo:1.0.3
[2024:01:31 14:17:48] Starting to install casecontrol:1.2.0...
[2024:01:31 14:17:48] Downloading code archive of casecontrol:1.2.0...
[**************************************************] 21.4 kB / 21.4 kB (100%)  
[2024:01:31 14:17:49] Extracting code archive of casecontrol:1.2.0...
[2024:01:31 14:17:49] Verifying code integrity of casecontrol:1.2.0...
[2024:01:31 14:17:49] Finished installation of casecontrol:1.2.0
[2024:01:31 14:17:49] Starting to install cravat-converter:1.1.2...
[2024:01:31 14:17:49] Downloading code archive of cravat-converter:1.1.2...

....[intermediate output skipped]

[**************************************************] 670 B / 670 B (100%)  
[2024:01:31 14:19:57] Extracting code archive of wgvcfinfo:1.0.3...
[2024:01:31 14:19:57] Verifying code integrity of wgvcfinfo:1.0.3...
[2024:01:31 14:19:57] Finished installation of wgvcfinfo:1.0.3</code></pre>
<p>Let’s list the available annotators. This is a very large list of annotators. This is just the first few entries.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="ex">tedladeras@teds-MacBook-Pro</span> local % oc module  ls <span class="at">-a</span> <span class="at">-t</span> annotator</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code>Name                               Title                                                 Type       Installed  Store ver   Store data ver     Local ver   Local data ver  Size      
abraom                             ABRaOM                                                annotator             1.0.0                                                      113.6 MB  
alfa                               ALFA: Allele Frequency Aggregator                     annotator             1.0.0       2020.02.29                                     19.8 GB   
alfa_african                       ALFA: Allele Frequency Aggregator African             annotator             1.0.0       2020.02.29                                     23.2 GB   
alfa_asian                         ALFA: Allele Frequency Aggregator Asian               annotator             1.0.0       2020.02.29                                     24.1 GB   
alfa_european                      ALFA: Allele Frequency Aggregator European            annotator             1.0.0       2020.02.29                                     19.8 GB   
alfa_latin_american                ALFA: Allele Frequency Aggregator Latin American      annotator             1.0.0       2020.02.29                                     20.3 GB   
alfa_other                         ALFA: Allele Frequency Aggregator Others      

....</code></pre>
<p>We’re actually looking for ClinVar, which is a list of clinically relevant annotations. Note that all of the annotators are in lower snake case (such as <code>alfa_asian</code>). So we can add <code>clinvar</code> in with our query.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="ex">oc</span> module ls <span class="at">-a</span> clinvar <span class="at">-t</span> annotator </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code>tedladeras@teds-MacBook-Pro local % oc module ls -a clinvar -t annotator 
Name     Title    Type       Installed  Store ver   Store data ver  Local ver  Local data ver  Size      
clinvar  ClinVar  annotator             2023.02.01  2023.02.01.1                               381.8 MB  </code></pre>
<p>Ok, now we know our annotator exists, and we can install it with the <code>oc module install</code> command:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="ex">oc</span> module install clinvar</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>We’ll need to confirm <code>y</code> to proceed:</p>
<pre><code>tedladeras@teds-MacBook-Pro local % oc module install clinvar
Installing: clinvar:2023.02.01, wgclinvar:1.1.1
Proceed? ([y]/n) &gt; y</code></pre>
<p>Then the installation will proceed:</p>
<pre><code>[2024:01:31 14:25:08] Starting to install clinvar:2023.02.01...
[2024:01:31 14:25:08] Downloading code archive of clinvar:2023.02.01...
[**************************************************] 290.9 kB / 290.9 kB (100%)  
[2024:01:31 14:25:09] Extracting code archive of clinvar:2023.02.01...
[2024:01:31 14:25:09] Verifying code integrity of clinvar:2023.02.01...
[2024:01:31 14:25:09] Downloading data of clinvar:2023.02.01...
[**************************************************] 49.0 MB / 49.0 MB (100%)  
[2024:01:31 14:25:15] Extracting data of clinvar:2023.02.01...
[2024:01:31 14:25:15] Verifying data integrity of clinvar:2023.02.01...
[2024:01:31 14:25:16] Finished installation of clinvar:2023.02.01
[2024:01:31 14:25:16] Starting to install wgclinvar:1.1.1...
[2024:01:31 14:25:16] Downloading code archive of wgclinvar:1.1.1...
[**************************************************] 36.8 kB / 36.8 kB (100%)  
[2024:01:31 14:25:17] Extracting code archive of wgclinvar:1.1.1...
[2024:01:31 14:25:17] Verifying code integrity of wgclinvar:1.1.1...
[2024:01:31 14:25:17] Finished installation of wgclinvar:1.1.1</code></pre>
</section>
<section id="understanding-the-input-file-format" class="level2">
<h2 class="anchored" data-anchor-id="understanding-the-input-file-format">Understanding the Input File Format</h2>
<p>[Video Here]</p>
<p>We can generate an example file using <code>oc new example-input</code>. Note the period at the end, which means that we will generate the file in the current directory:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="ex">oc</span> new example-input .</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Let’s confirm that we created this example:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ls</span> <span class="at">-l</span> example<span class="pp">*</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code>tedladeras@teds-MacBook-Pro ~ % ls -l example*
-rw-r--r--  1 tedladeras  staff    9036 Jan 31 14:27 example_input</code></pre>
<p>Note the created file has an underscore (<code>_</code>) rather than a dash (<code>-</code>). Let’s take a look at the <code>example_input</code> file that we created:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span> example_input <span class="kw">|</span> <span class="fu">head</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code>chr1    69091   +   A   C   s0
chr1    69091   +   ATG C   s0
chr6    31039077    +   C   G   s0
chr1    27612918    +   G   a   s1
chr1    27612918    +   G   A   s0
chrM    235 +   A   G   clinvar
chrM    3308    +   T   C   omim
chr8    54626835    +   A   T   s0
chr4    1804372 +   A   G   s1
chr4    1804372 +   AT  GC  s1
chr4    1804372 +   A   T   s1</code></pre>
</section>
<section id="annotating-our-example" class="level2">
<h2 class="anchored" data-anchor-id="annotating-our-example">Annotating our example</h2>
<iframe src="https://share.descript.com/embed/sxm0Qpy7NfL" width="640" height="360" frameborder="0" allowfullscreen="">
</iframe>
<p>Now we have our example, we can run Open Cravat. This will annotate our <code>example_input</code> file with all available annotators.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="ex">oc</span> run ./example_input <span class="at">-l</span> hg38</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code>tedladeras@teds-MacBook-Pro ~ % oc run ./example_input -l hg38
Input file(s): /Users/tedladeras/example_input
Genome assembly: hg38
Running converter...
    Converter (converter)           finished in 0.124s
Running gene mapper...                  finished in 2.668s
Running annotators...
    annotator(s) finished in 1.466s
Running aggregator...
    Variants                        finished in 0.010s
    Genes                           finished in 0.003s
    Samples                         finished in 0.022s
    Tags                            finished in 0.025s
Indexing
    variant base__coding    finished in 0.000s
    variant base__chrom finished in 0.000s
    variant base__so    finished in 0.000s
Running postaggregators...
    Tag Sampler (tagsampler)        finished in 0.008s
Finished normally. Runtime: 4.539s</code></pre>
</section>
<section id="starting-the-results-viewer" class="level2">
<h2 class="anchored" data-anchor-id="starting-the-results-viewer">Starting the Results Viewer</h2>
<iframe src="https://share.descript.com/embed/FRREXxdcxXH" width="640" height="360" frameborder="0" allowfullscreen="">
</iframe>
<p>We saw that one of the files generated was an <code>.sqlite</code> file. These are our results, which we can visualize using <code>oc gui</code>, which will launch the a web server so we can examine our results using the GUI:</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="ex">oc</span> gui example_input.sqlite</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code>tedladeras@teds-MacBook-Pro ~ % oc gui example_input.sqlite

   ____                   __________  ___ _    _____  ______
  / __ \____  ___  ____  / ____/ __ \/   | |  / /   |/_  __/
 / / / / __ \/ _ \/ __ \/ /   / /_/ / /| | | / / /| | / /   
/ /_/ / /_/ /  __/ / / / /___/ _, _/ ___ | |/ / ___ |/ /    
\____/ .___/\___/_/ /_/\____/_/ |_/_/  |_|___/_/  |_/_/     
    /_/                                                     

OpenCRAVAT is served at localhost:8080
(To quit: Press Ctrl-C or Ctrl-Break if run on a Terminal or Windows, or click "Cancel" and then "Quit" if run through OpenCRAVAT app on Mac OS)
(Getting result of [example_input.sqlite]:[variant]...)
Done getting result of [example_input.sqlite][variant] in 0.029s
(Getting result of [example_input.sqlite]:[gene]...)
Done getting result of [example_input.sqlite][gene] in 0.021s</code></pre>
<p>A window should open in your web browser. If not, enter https://localhost:8080 to view the file.</p>
<p><img src="oc-gui.png" class="img-fluid"></p>
</section>
<section id="examining-our-results-file-and-filtering" class="level2">
<h2 class="anchored" data-anchor-id="examining-our-results-file-and-filtering">Examining our Results File and Filtering</h2>
<p>Now we take a look at our results in the web interface. Under the list of jobs, we can see our job. Let’s select <code>Open Result Viewer</code> under the <strong>Status</strong> tab:</p>
<p><img src="images/oc-filter-job.png" class="img-fluid"></p>
<p>Keep in mind that the web interface is limited to visualizing 100,000 variants, so if you have a larger result file, you’ll need to filter the results down. So let’s take a look at how to filter our variants down.</p>
<p>We can filter variants by selecting the Filter tab in the Results viewer:</p>
<p><img src="images/oc-filter-select-tab.png" class="img-fluid"></p>
<p>Under “Variant Properties” we can limit our list of variants to those that have ClinVar annotations. Let’s build a filter using the Query Builder, which will allow us to impose multiple criteria as a filter.</p>
<p><img src="images/oc-filter-query-builder.png" class="img-fluid"></p>
<p>We’ll add a rule (a logical condition) to our filter using the <code>+</code> button:</p>
<p><img src="images/oc-filter-add-rule.png" class="img-fluid"></p>
<p>Now we’ll add a rule and select those that have <code>ClinVar</code> annotations. To do this, we’ll first select a) <code>ClinVar</code> on the left, the b) <code>Clinical Significance</code> column, and c) <code>has data</code>:</p>
<p><img src="images/oc-filter-create.png" class="img-fluid"> Now we can apply this rule we’ve built by clicking on the <strong>Apply Filter</strong> button on the bottom right of the Query Builder:</p>
<p><img src="images/oc-filter-apply.png" class="img-fluid"> How many variants are left after the filtering?</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Calculating the Effect of Filters
</div>
</div>
<div class="callout-body-container callout-body">
<p>If you have multiple filters, you can actually precalculate the numbers of variants after filtering by using the icon below.</p>
<p><img src="images/oc-filter-precalculate.png" class="img-fluid"></p>
<p>This can be helpful to check if your filters are too strict (that is, they won’t return anything).</p>
<p>Just note that the filter is not actually applied to the data until you hit the <strong>Apply Filter</strong> Button.</p>
</div>
</div>
</section>
<section id="visualizing-our-filtered-results" class="level2">
<h2 class="anchored" data-anchor-id="visualizing-our-filtered-results">Visualizing Our Filtered Results</h2>
<iframe src="https://share.descript.com/embed/13Ww6z6RV6j" width="640" height="360" frameborder="0" allowfullscreen="">
</iframe>
<p>Now that we’ve filtered, let’s go back to the Summary Tab:</p>
<p><img src="images/oc-visualize-tab.png" class="img-fluid"> In the Summary tab, we can see information about the annotated variants, such as from the sequence ontology. We can get the counts within a sequence ontology category by mousing over that category in our plot:</p>
<p><img src="images/oc-visualize-seq-ontology.png" class="img-fluid"> These visualizations can be moved around and pinned. Using the camera icon, you can also save these visualizations.</p>
<p>Let’s move over to the <strong>Variant</strong> tab and look for pathogenic variants. First, we’ll click over to the <strong>Variant</strong> tab:</p>
<p><img src="images/oc-visualize-variant.png" class="img-fluid"> Scrolling to the right, we can see there is a column for the ClinVar annotations. Notice the <strong>+</strong> on the top right. We’ll click that to expand the ClinVar annotations:</p>
<p><img src="images/oc-visualize-clinvar.png" class="img-fluid"> In the <strong>Clinical Significance</strong> column, we can see that we can filter. Let’s select those variants that have <strong>pathogenic</strong> significance. Clicking into the search box underneath this column, we can select <strong>pathogenic</strong>:</p>
<p><img src="images/oc-visualize-pathogenic.png" class="img-fluid"></p>
<p>How many variants are pathogenic?</p>
<p>The last thing we might want to do is to export our results. We can use the export button at the bottom of the table:</p>
<p><img src="images/oc-export-table.png" class="img-fluid"></p>
<p>When you click that, you will have the option to export the variant level results as a tab seperated value (TSV) file. Note that this result table will have filters applied to it as well.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Multiple Rules
</div>
</div>
<div class="callout-body-container callout-body">
<p>Note that we could have limited our search to pathogenic variants by adding another filter rule like we did above in the filtering step. We’re showing this way in case you didn’t know the available categories within the <code>Clinical Significance</code> column.</p>
</div>
</div>
</section>
<section id="deactivating-your-environment" class="level2">
<h2 class="anchored" data-anchor-id="deactivating-your-environment">Deactivating Your Environment</h2>
<p>When you’re done using Open-Cravat and it’s installed by an environment, make sure to deactivate:</p>
<p>For the <code>python/venv</code> installation:</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="ex">deactivate</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>For the <code>mamba/conda</code> installation:</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="ex">mamba</span> deactivate</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="what-you-learned" class="level2">
<h2 class="anchored" data-anchor-id="what-you-learned">What You Learned</h2>
<p>We learned the following in this section:</p>
<ul>
<li><strong>Prepare</strong> your system for installing OpenCRAVAT</li>
<li><strong>Install</strong> the OpenCRAVAT software locally using <code>pip</code></li>
<li><strong>Search</strong> for and <strong>Install</strong> available annotators</li>
<li><strong>Explain</strong> compatible variant formats</li>
<li><strong>Annotate</strong> variant files using the CLI tools</li>
<li><strong>Visualize</strong> and <strong>Summarize</strong> Results in OpenCRAVAT</li>
</ul>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>